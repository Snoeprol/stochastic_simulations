# Calculates the variances for Figure 5 in the report,
# using 10 simulations per tuple (i,n)

import numpy as np
from tqdm import tqdm
from control_variets import iterate_over_random_candidate
from control_variets import Zn_1


def get_variance(point):
    its = int(point[0])
    n = int(point[1])

    simulations = 10

    # Lists with average areas and norms per run
    areas = []
    all_norms = []

    # Do simulations
    for i in tqdm(range(simulations)):
        count = 0
        for x in range(n):

            converger, z, norm = iterate_over_random_candidate(its)
            if converger > its - 1:
                count += 1
        areas.append(count/n * 6)

    variance_areas = np.var(areas)
    return variance_areas

def get_variances(data):
    variances = []
    for point in data:
        variance = get_variance(point)
        variances.append(variance)
    print(variances)
    file2write=open("variances.txt",'w')
    file2write.write(variances)
    file2write.close()

data = np.array([[2.00000000e+02, 1.71843369e+04],
       [1.98860560e+02, 1.80000000e+04],
       [1.98000000e+02, 1.86113165e+04],
       [1.97452760e+02, 1.90000000e+04],
       [1.96034058e+02, 2.00000000e+04],
       [1.96000000e+02, 2.00238259e+04],
       [1.94604373e+02, 2.10000000e+04],
       [1.94000000e+02, 2.14195696e+04],
       [1.93163784e+02, 2.20000000e+04],
       [1.92000000e+02, 2.28018056e+04],
       [1.91712286e+02, 2.30000000e+04],
       [1.90249834e+02, 2.40000000e+04],
       [1.90000000e+02, 2.41695831e+04],
       [1.88776421e+02, 2.50000000e+04],
       [1.88000000e+02, 2.55231143e+04],
       [1.87292084e+02, 2.60000000e+04],
       [1.86000000e+02, 2.68641357e+04],
       [1.85796820e+02, 2.70000000e+04],
       [1.84290578e+02, 2.80000000e+04],
       [1.84000000e+02, 2.81915452e+04],
       [1.82773368e+02, 2.90000000e+04],
       [1.82000000e+02, 2.95061197e+04],
       [1.81245217e+02, 3.00000000e+04],
       [1.80000000e+02, 3.08090808e+04],
       [1.79706120e+02, 3.10000000e+04],
       [1.78156047e+02, 3.20000000e+04],
       [1.78000000e+02, 3.20999753e+04],
       [1.76594974e+02, 3.30000000e+04],
       [1.76000000e+02, 3.33785105e+04],
       [1.75022941e+02, 3.40000000e+04],
       [1.74000000e+02, 3.46462400e+04],
       [1.73439943e+02, 3.50000000e+04],
       [1.72000000e+02, 3.59033833e+04],
       [1.71845975e+02, 3.60000000e+04],
       [1.70240994e+02, 3.70000000e+04],
       [1.70000000e+02, 3.71491511e+04],
       [1.68625011e+02, 3.80000000e+04],
       [1.68000000e+02, 3.83841937e+04],
       [1.66998044e+02, 3.90000000e+04],
       [1.66000000e+02, 3.96093600e+04],
       [1.65360089e+02, 4.00000000e+04],
       [1.64000000e+02, 4.08248438e+04],
       [1.63711140e+02, 4.10000000e+04],
       [1.62051183e+02, 4.20000000e+04],
       [1.62000000e+02, 4.20306350e+04],
       [1.60380180e+02, 4.30000000e+04],
       [1.60000000e+02, 4.32260544e+04],
       [1.58698170e+02, 4.40000000e+04],
       [1.58000000e+02, 4.44124180e+04],
       [1.57005147e+02, 4.50000000e+04],
       [1.56000000e+02, 4.55898982e+04],
       [1.55301106e+02, 4.60000000e+04],
       [1.56000000e+02, 4.60325287e+04],
       [1.58000000e+02, 4.61256293e+04],
       [1.60000000e+02, 4.62187443e+04],
       [1.62000000e+02, 4.63118737e+04],
       [1.64000000e+02, 4.64050174e+04],
       [1.66000000e+02, 4.64981755e+04],
       [1.68000000e+02, 4.65913480e+04],
       [1.70000000e+02, 4.66845349e+04],
       [1.72000000e+02, 4.67777362e+04],
       [1.74000000e+02, 4.68709518e+04],
       [1.76000000e+02, 4.69641818e+04],
       [1.76768264e+02, 4.70000000e+04],
       [1.76000000e+02, 4.74459199e+04],
       [1.75045242e+02, 4.80000000e+04],
       [1.74000000e+02, 4.86028171e+04],
       [1.73311207e+02, 4.90000000e+04],
       [1.72000000e+02, 4.97514149e+04],
       [1.71566156e+02, 5.00000000e+04],
       [1.70000000e+02, 5.08918662e+04],
       [1.69810083e+02, 5.10000000e+04],
       [1.68042976e+02, 5.20000000e+04],
       [1.68000000e+02, 5.20241726e+04],
       [1.66264810e+02, 5.30000000e+04],
       [1.66000000e+02, 5.31480242e+04],
       [1.64475609e+02, 5.40000000e+04],
       [1.64000000e+02, 5.42642215e+04],
       [1.62675366e+02, 5.50000000e+04],
       [1.62000000e+02, 5.53729015e+04],
       [1.60864079e+02, 5.60000000e+04],
       [1.60000000e+02, 5.64741977e+04],
       [1.59041740e+02, 5.70000000e+04],
       [1.58000000e+02, 5.75682408e+04],
       [1.57208345e+02, 5.80000000e+04],
       [1.56000000e+02, 5.86551580e+04],
       [1.55363890e+02, 5.90000000e+04],
       [1.54000000e+02, 5.97350740e+04],
       [1.53508368e+02, 6.00000000e+04],
       [1.52000000e+02, 6.08081103e+04],
       [1.51641775e+02, 6.10000000e+04],
       [1.50000000e+02, 6.18743856e+04],
       [1.49764106e+02, 6.20000000e+04],
       [1.48000000e+02, 6.29340161e+04],
       [1.47875355e+02, 6.30000000e+04],
       [1.46000000e+02, 6.39871152e+04],
       [1.45975517e+02, 6.40000000e+04],
       [1.44064578e+02, 6.50000000e+04],
       [1.44000000e+02, 6.50336036e+04],
       [1.42142539e+02, 6.60000000e+04],
       [1.42000000e+02, 6.60737452e+04],
       [1.40209400e+02, 6.70000000e+04],
       [1.40000000e+02, 6.71077175e+04],
       [1.38265156e+02, 6.80000000e+04],
       [1.38000000e+02, 6.81356231e+04],
       [1.36309801e+02, 6.90000000e+04],
       [1.36000000e+02, 6.91575619e+04],
       [1.34343330e+02, 7.00000000e+04],
       [1.34000000e+02, 7.01736321e+04],
       [1.32365737e+02, 7.10000000e+04],
       [1.32000000e+02, 7.11839293e+04],
       [1.30377019e+02, 7.20000000e+04],
       [1.30000000e+02, 7.21885474e+04],
       [1.28377169e+02, 7.30000000e+04],
       [1.28000000e+02, 7.31875780e+04],
       [1.26366183e+02, 7.40000000e+04],
       [1.26000000e+02, 7.41811110e+04],
       [1.24344055e+02, 7.50000000e+04],
       [1.24000000e+02, 7.51692341e+04],
       [1.22310780e+02, 7.60000000e+04],
       [1.22000000e+02, 7.61520334e+04],
       [1.20266353e+02, 7.70000000e+04],
       [1.20000000e+02, 7.71295930e+04],
       [1.18210769e+02, 7.80000000e+04],
       [1.18000000e+02, 7.81019954e+04],
       [1.16144023e+02, 7.90000000e+04],
       [1.16000000e+02, 7.90693212e+04],
       [1.14066109e+02, 8.00000000e+04],
       [1.16000000e+02, 8.00912920e+04],
       [1.18000000e+02, 8.01857194e+04],
       [1.20000000e+02, 8.02801614e+04],
       [1.22000000e+02, 8.03746180e+04],
       [1.24000000e+02, 8.04690893e+04],
       [1.26000000e+02, 8.05635752e+04],
       [1.28000000e+02, 8.06580757e+04],
       [1.30000000e+02, 8.07525908e+04],
       [1.32000000e+02, 8.08471206e+04],
       [1.34000000e+02, 8.09416650e+04],
       [1.35233832e+02, 8.10000000e+04],
       [1.34000000e+02, 8.15885584e+04],
       [1.33137336e+02, 8.20000000e+04],
       [1.32000000e+02, 8.25396590e+04],
       [1.31029677e+02, 8.30000000e+04],
       [1.30000000e+02, 8.34860043e+04],
       [1.28910850e+02, 8.40000000e+04],
       [1.28000000e+02, 8.44276671e+04],
       [1.26780850e+02, 8.50000000e+04],
       [1.26000000e+02, 8.53647182e+04],
       [1.24639671e+02, 8.60000000e+04],
       [1.24000000e+02, 8.62972272e+04],
       [1.22487309e+02, 8.70000000e+04],
       [1.22000000e+02, 8.72252625e+04],
       [1.20323757e+02, 8.80000000e+04],
       [1.20000000e+02, 8.81488908e+04],
       [1.18149011e+02, 8.90000000e+04],
       [1.18000000e+02, 8.90681778e+04],
       [1.16000000e+02, 8.99831042e+04],
       [1.15963061e+02, 9.00000000e+04],
       [1.14000000e+02, 9.08934602e+04],
       [1.13765880e+02, 9.10000000e+04],
       [1.12000000e+02, 9.17996477e+04],
       [1.11557489e+02, 9.20000000e+04],
       [1.10000000e+02, 9.27017277e+04],
       [1.09337880e+02, 9.30000000e+04],
       [1.08000000e+02, 9.35997602e+04],
       [1.07107050e+02, 9.40000000e+04],
       [1.06000000e+02, 9.44938039e+04],
       [1.04864992e+02, 9.50000000e+04],
       [1.04000000e+02, 9.53839164e+04],
       [1.02611702e+02, 9.60000000e+04],
       [1.02000000e+02, 9.62701542e+04],
       [1.00347175e+02, 9.70000000e+04],
       [1.00000000e+02, 9.71525728e+04],
       [9.80714045e+01, 9.80000000e+04],
       [9.80000000e+01, 9.80312264e+04],
       [9.60000000e+01, 9.89057231e+04],
       [9.57843526e+01, 9.90000000e+04],
       [9.40000000e+01, 9.97764001e+04],
       [9.34860345e+01, 1.00000000e+05]])

if __name__ == "__main__":
    get_variances(data)
